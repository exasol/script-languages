#
language: python
python: "3.6"
dist: xenial # trusty fails with weird FileNotFoundError in ExportContainerTask

sudo:  required
services:
    - docker

install:
  - sudo pip install pipenv

before_script:
  - docker pull exasol/docker-db:6.0.12-d1

jobs:
  include:
    - stage: build
      script:
        - ./exaslct build --flavor-path flavors/standard-EXASOL-6.1.0 --docker-repository-name docker.io/tkilias/script-language-container
    - stage: test
      script:
        - ./exaslct run-db-test --flavor-path flavors/standard-EXASOL-6.1.0 --generic-test-lang=python --docker-repository-name docker.io/tkilias/script-language-container
    - script:
        - ./exaslct run-db-test --flavor-path flavors/standard-EXASOL-6.1.0 --test-folder=python --docker-repository-name docker.io/tkilias/script-language-container
    - script:
        - ./exaslct run-db-test --flavor-path flavors/standard-EXASOL-6.1.0 --generic-test-lang=java --docker-repository-name docker.io/tkilias/script-language-container
    - script:
        - ./exaslct run-db-test --flavor-path flavors/standard-EXASOL-6.1.0 --test-folder=java --docker-repository-name docker.io/tkilias/script-language-container
    - script:
        - ./exaslct run-db-test --flavor-path flavors/standard-EXASOL-6.1.0 --generic-test-lang=r --docker-repository-name docker.io/tkilias/script-language-container
    - script:
        - ./exaslct run-db-test --flavor-path flavors/standard-EXASOL-6.1.0 --test-folder=r --docker-repository-name docker.io/tkilias/script-language-container
    - script:
        - ./exaslct run-db-test --flavor-path flavors/standard-EXASOL-6.1.0 --generic-test-lang=python3 --docker-repository-name docker.io/tkilias/script-language-container
    - script:
        - ./exaslct run-db-test --flavor-path flavors/standard-EXASOL-6.1.0 --test-folder=python3 --docker-repository-name docker.io/tkilias/script-language-container
    - script:
        - ./exaslct run-db-test --flavor-path flavors/standard-EXASOL-6.1.0 --test-folder=standard-flavor --docker-repository-name docker.io/tkilias/script-language-container
stages:
  - build
  - test